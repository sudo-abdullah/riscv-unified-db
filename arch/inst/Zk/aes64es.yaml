# yaml-language-server: $schema=../../../schemas/inst_schema.json

$schema: "inst_schema.json#"
kind: instruction
name: aes64es
long_name: AES final round encryption instruction for RV64
description: |
  Uses the two 64-bit source registers to represent the entire AES state, and produces half of the next
  round output, applying the ShiftRows and SubBytes steps. This instruction must always be
  implemented such that its execution latency does not depend on the data being operated on
definedBy:
  anyOf: [Zk, Zkn, Zkne]
base: 64
assembly: xd, xs1, xs2
encoding:
  match: 0011001----------000-----0110011
  variables:
    - name: rs2
      location: 24-20
    - name: rs1
      location: 19-15
    - name: rd
      location: 11-7
access:
  s: always
  u: always
  vs: always
  vu: always
data_independent_timing: true
operation(): |
